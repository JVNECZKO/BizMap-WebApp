# 1) NIGDY nie pokazuj listingu katalogów
Options -Indexes

# 2) Zablokuj dotfile'e (.env, .git, .htaccess itd.)
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# 3) Zablokuj typowe wrażliwe pliki (na wszelki wypadek)
<FilesMatch "(^composer\.(json|lock)$|^package\.json$|^phpunit\.xml$|^vite\.config\.js$|^artisan$|^server\.php$|^README\.md$|^error_log$)">
    Require all denied
</FilesMatch>

# 4) Zablokuj dostęp do wrażliwych katalogów aplikacji (KRYTYCZNE)
RedirectMatch 404 ^/(app|bootstrap|config|database|resources|routes|storage|tests|vendor)(/|$)

<IfModule mod_rewrite.c>
    RewriteEngine On

    # 5) Jeśli ktoś wejdzie /public/... to zrób 301 na /...
    RewriteRule ^public/(.*)$ /$1 [R=301,L]

    # 6) Ruch kieruj do /public (shared hosting bez zmiany docroot)
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ public%{REQUEST_URI} [L]
</IfModule>